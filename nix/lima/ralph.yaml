# Lima configuration for Ralph NixOS VM
#
# This is a reference template. Normally you should use:
#   ./scripts/create-ralph.sh ralph-1
#
# For manual usage:
#   1. Build the NixOS image: cd nix && nix build .#qcow
#   2. Start VM: limactl start ./nix/lima/ralph.yaml --name ralph-1
#
# The NixOS image includes all tools pre-installed via Nix:
#   - claude, codex, opencode (agent CLIs via bun)
#   - git, jj (jujutsu), gh
#   - tmux, ripgrep, fd, jq
#   - node.js, bun
#   - chromium + playwright

images:
  - location: "../result/nixos.qcow2"
    arch: "aarch64"
  - location: "../result/nixos.qcow2"
    arch: "x86_64"

cpus: 4
memory: "6GiB"
disk: "30GiB"

vmType: "vz"
rosetta:
  enabled: true

mounts:
  - location: "~/tasks"
    mountPoint: "/mnt/tasks"
    writable: false
  - location: "~/ralph-workspaces"
    mountPoint: "/workspace"
    writable: true

networks:
  - lima: shared

portForwards:
  - guestPort: 9222
    hostPort: 9222
  - guestPort: 3000
    hostPort: 3000
  - guestPort: 8080
    hostPort: 8080

ssh:
  localPort: 0
  loadDotSSHPubKeys: true

containerd:
  system: false
  user: false

provision: []
